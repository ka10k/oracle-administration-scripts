

--truncate table SIP_W.TB_ACCOUNTS_JN;

--<2010
insert /*+ APPEND */ into SIP_W.TB_ACCOUNTS_JN select * from  SIP_W.TB_ACCOUNTS_JN_OLD_DATA where 
JACC_DATETIME <  TO_DATE('2010-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS', 'NLS_CALENDAR=GREGORIAN');
commit;

-->=2010 < 2013
insert /*+ APPEND */ into SIP_W.TB_ACCOUNTS_JN select * from  SIP_W.TB_ACCOUNTS_JN_OLD_DATA where 
JACC_DATETIME >=  TO_DATE('2010-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS', 'NLS_CALENDAR=GREGORIAN') and 
JACC_DATETIME <  TO_DATE('2013-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS', 'NLS_CALENDAR=GREGORIAN');
commit;

 
-->=2013 <2015
insert /*+ APPEND */ into SIP_W.TB_ACCOUNTS_JN select * from  SIP_W.TB_ACCOUNTS_JN_OLD_DATA where 
JACC_DATETIME >=  TO_DATE('2013-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS', 'NLS_CALENDAR=GREGORIAN') and 
JACC_DATETIME <  TO_DATE('2015-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS', 'NLS_CALENDAR=GREGORIAN');
commit;

-- >=2015
insert /*+ APPEND */ into SIP_W.TB_ACCOUNTS_JN select * from  SIP_W.TB_ACCOUNTS_JN_OLD_DATA where 
JACC_DATETIME >=  TO_DATE('2015-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS', 'NLS_CALENDAR=GREGORIAN');
commit;